#include "vulnerability_predicates.h"
#include <string.h> // For strchr

int buffer_overflow_occurred(int index, int buffer_size) {
    return !(index >= 0 && index < buffer_size);
}

// int integer_overflow_occurred(int index) {
//     return !(index >= 0 && index < BUFFER_SIZE); // Ensure BUFFER_SIZE is defined or passed correctly
// }

int command_injection_possible(const char *command_buffer) {
    const char *special_chars = "&;|$`<>";
    while (*command_buffer) {
        if (strchr(special_chars, *command_buffer))
            return 1;
        command_buffer++;
    }
    return 0;
}

int buffer_underflow_occurred(char *base, char *data) {
    return data < base;
}

int buffer_overread_occurred(size_t size_to_read, size_t actual_buffer_size) {
    return size_to_read > actual_buffer_size;
}

// int integer_underflow_occurred(int index) {
//     return !(index >= 0 && index < BUFFER_SIZE); // Ensure BUFFER_SIZE is defined
// }
